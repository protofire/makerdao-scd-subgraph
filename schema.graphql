" Collateralized Debt Position "
type Cdp @entity {
  " CDP ID "
  id: ID!

  " CDP owner "
  owner: Bytes!

  " Collateral amount [PETH] "
  collateral: BigDecimal!

  " Outstanding debt [DAI] "
  debt: BigDecimal!

  " Creation timestamp as seconds "
  created: BigInt!

  " Block number in which the CDP was created "
  createdAtBlock: BigInt!

  " Transaction hash in which the CDP was created "
  createdAtTransaction: Bytes!

  " Flag indicating if the CDP has been shut "
  deleted: Boolean

  " Most recent action "
  latestAction: CdpAction!

  " Timestamp of most recent action as seconds "
  timestamp: BigInt!

  " CDP operations "
  actions: [CdpAction!]! @derivedFrom(field: "cdp")
}

" Operation over a Collateralized Debt Position (CDP) "
type CdpAction @entity {
  " Action ID (<transaction_hash>-<action_type>) "
  id: ID!

  " CDP ID "
  cdp: Cdp!

  " Action name "
  type: ActionType!

  " Action value "
  value: String

  " Sender address "
  sender: Bytes!

  " Block number "
  block: BigInt!

  " Transaction hash "
  transactionHash: Bytes!

  " Action timestamp as seconds "
  timestamp: BigInt!
}

enum ActionType {
  OPEN
  GIVE
  LOCK
  FREE
  DRAW
  WIPE
  SHUT
  BITE
}
